<!DOCTYPE html>
<html lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>Update Covid 19</title>
	<link rel="stylesheet" href="css/materialize.min.css">
	<link rel="stylesheet" href="css/style.css">
	<link href="https://fonts.googleapis.com/css?family=Baloo+Thambi+2&display=swap" rel="stylesheet">
</head>
<body>
	<div class="container">
		<h1 class="center-align">Data Covid-19 Indonesia</h1>
		<div id="waktu"></div>
		<div id="data"></div>

		<h1 class="center-align">Data Provinsi</h1>
		<div id="provinsi" class="row">
			
		</div>

		<div class="sumber">
			Sumber: 
			<a href="https://kawalcorona.com/" target="_blank">
				<i>https://kawalcorona.com/</i>
			</a>
		</div>
	</div>
	<script src="js/jquery-1.11.2.min.js"></script>
	<script src="js/materialize.min.js"></script>
	<script>
		var url = 'https://api.kawalcorona.com/indonesia/';

			var a = new Date();
			var senin = a.getDay();
			var getHari = a.getDate();
			var getBulan = a.getMonth() + 1;
			var getTahun = a.getFullYear();
				// var timee = response.metadata.lastUpdatedAt;
				// var a = timee.substr(0,10);
				// var tanggal = a.substr(8,9);
				// var bulan = a.substr(5,2);
				// var tahun = a.substr(0,4);

				var monthWording = {
						'1':'Januari',
						'2':'Februari',
						'3':'Maret',
						'4':'April',
						'5':'Mei',
						'6':'Juni',
						'7':'Juli',
						'8':'Agustus',
						'9':'September',
						'10':'Oktober',
						'11':'November',
						'12':'Desember',
					}
				
				var hariWording = {
					'1' : 'Senin',
					'2'	: 'Selasa',
					'3' : 'Rabu',
					'4' : 'Kamis',
					'5' : 'Jumat',
					'6' : 'Sabtu',
					'7' : 'Minggu'
				}


				var timeHighlight = `
					<div>${hariWording[senin]}, ${getHari} ${monthWording[getBulan]} ${getTahun}</div>
				`

		$.ajax({
			url: url,
			type: 'GET',
			success: function(response) {
				var style = `
					<div class="row">
						<div class="col s12 m6 l6 xl4">
								<div class="blocking card gradient-green white-text">
									<div class="row">
										<div class="col s7 m7">
											<i class="material-icons background-round mt-5">accessibility</i>
										</div>
										
										<div class="col s5 m5 right-align">
											<h2>Sembuh</h2>
											<div class="value">${response[0].sembuh}</div>
										</div>
									</div>
								</div>
							</div>
						<div class="col s12 m6 l6 xl4">
							<div class="blocking card gradient-cyan white-text">
								
								<div class="row">
									<div class="col s7 m7">										
										<i class="material-icons background-round mt-5">show_chart</i>
									</div>
									
									<div class="col s5 m5 right-align">
										<h2>Positif</h2>
										<div class="value">${response[0].positif}</div>
									</div>
								</div>
							</div>
						</div>
						<div class="col s12 m6 l6 xl4">
							<div class="blocking card gradient-red white-text">
								<div class="row">
									<div class="col s7 m7">
										<i class="material-icons background-round mt-5">warning</i>
									</div>
									
									<div class="col s5 m5 right-align">
										<h2>Meninggal</h2>
										<div class="value">${response[0].meninggal}</div>
									</div>
								</div>
							</div>
						</div>
					</div>
				`

				$("#waktu").append(timeHighlight);
				$("#data").append(style);
			},
			error: function(resp){
				console.log(resp)
			}

		});

		

		$.ajax({
			url: url + 'provinsi/',
			type: 'GET',
			success: function(response) {
				// console.log(response[0].attributes);
				var resp = response;
				var text = "";
				var daerah="";
				var a;
				for (a=0; a<response.length; a++ ) {
					// console.log(response[a].attributes.Kasus_Semb)
					// console.log(response[a].attributes.Provinsi)
					// console.log(response[a].attributes.Kasus_Meni)
					var prov = response[a].attributes.Provinsi;
					var sembuh = response[a].attributes.Kasus_Semb;
					var positif = response[a].attributes.Kasus_Posi;
					var meninggal = response[a].attributes.Kasus_Meni;
					daerah += `
					<div class="col s6 xl3">
						<div class="card horizontal">
			      			<div class="card-stacked">				
								<div class="card-action">
						          <span>${prov}</span>
						        </div>
						        <div class="card-content">
						          <p>Sembuh: <b>${sembuh}</b></p>
						          <p>Positif: <b>${positif}</b></p>
						          <p>Meninggal: <b>${meninggal}</b></p>
						        </div>
					        </div>
				        </div>
			        </div>  
								     
						`;
				}

				$("#provinsi").append(daerah);	
			}
		})
	</script>
</body>
</html>
